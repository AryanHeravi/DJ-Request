<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Song Request</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg-dark:#0b0b0d;
  --panel:rgba(30,30,35,0.75);
  --text:#e5e5e5;
  --accent:#00ffd0;
  --highlight:#ff4d4d;
  --gold:#d4af37;
  --admin:#8E8E93;
}

/* Reset & body */
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:'Montserrat',sans-serif;
  background: 
    radial-gradient(circle at top left, rgba(255,255,255,0.05), transparent 70%),
    linear-gradient(180deg, #0b0b0d, #1a1a1f);
  color:var(--text);
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
  padding:20px;
  backdrop-filter: blur(2px);
}

h1{
  text-align:center;
  margin-bottom:10px;
  font-weight:600;
}

.container{
  width:100%;
  max-width:400px;
  display:flex;
  flex-direction:column;
  gap:20px;
}

/* Lane cards */
.lane-select{
  display:flex;
  flex-direction:column;
  gap:16px;
}

.lane-card{
  background:var(--panel);
  padding:18px;
  border-radius:16px;
  cursor:pointer;
  font-weight:600;
  text-align:center;
  transition:0.25s ease, transform 0.2s ease;
  box-shadow:0 4px 12px rgba(0,0,0,0.4);
  position:relative;
  overflow:hidden;
  color:var(--text);
}

.lane-card.selected{
  border:2px solid var(--accent);
  background:rgba(30,30,35,0.95);
}

.lane-card.selected::after{
  box-shadow: 0 0 15px rgba(0,255,208,0.3);
}

.lane-card:hover{
  transform:scale(1.03);
}

/* Payment buttons */
#paymentOptions{
  display:none;
  flex-direction:column;
  gap:12px;
  margin-top:10px;
}

#paypalBtn{
  background:linear-gradient(135deg,#0070ba,#00a1ff);
  color:white;
}

#cashBtn{
  background:linear-gradient(135deg,#28a745,#85e085);
  color:white;
}

button{
  padding:14px;
  border:none;
  border-radius:14px;
  font-weight:600;
  font-size:16px;
  cursor:pointer;
  transition: all 0.2s ease;
}

button:hover{
  transform:scale(1.02);
}

button:active{
  transform:scale(0.97);
}

/* Form */
form{
  display:none;
  flex-direction:column;
  gap:12px;
  background:var(--panel);
  padding:20px;
  border-radius:16px;
  box-shadow:0 4px 20px rgba(0,0,0,0.6);
  margin-top:10px;
}

input{
  padding:14px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.1);
  background:rgba(20,20,25,0.85);
  color:var(--text);
  font-size:15px;
}

.submit-btn{
  background:linear-gradient(135deg,var(--highlight),#ff1a66);
  color:white;
}

/* Lanes display */
.lanes{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px;
}

.lane{
  background:var(--panel);
  padding:16px;
  border-radius:16px;
  box-shadow:0 4px 12px rgba(0,0,0,0.4);
}

.lane h3{
  margin-bottom:12px;
  color:var(--accent);
  font-weight:600;
}

.request{
  padding:10px 12px;
  border-radius:12px;
  background:rgba(40,40,45,0.85);
  margin-bottom:10px;
  font-size:14px;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
}

.request.approved-priority{
  animation:goldPulse 3s ease infinite;
  background:linear-gradient(270deg,var(--gold),#ffec9e,var(--gold));
  background-size:300% 300%;
  color:black;
}

@keyframes goldPulse{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* Admin button */
.admin-btn{
  margin-top:20px;
  background:var(--admin);
  color:white;
  width:100%;
  border-radius:14px;
  cursor:pointer;
}

/* Slide animations */
@keyframes slideIn {
  0% { opacity:0; transform:translateY(20px);}
  100% { opacity:1; transform:translateY(0);}
}

@keyframes slideOut {
  0% { opacity:1; transform:translateY(0);}
  100% { opacity:0; transform:translateY(20px);}
}

.show{
  display:flex !important;
  animation: slideIn 0.35s ease forwards;
}

.hide{
  animation: slideOut 0.35s ease forwards;
}

/* Responsive */
@media(max-width:700px){
  .lanes{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<h1>GRANVILLE WAREHOUSE</h1>
<h1>ðŸŽµ SONG REQUEST ðŸŽµ</h1>

<div class="container">

  <!-- Lane selection -->
  <div class="lane-select">
    <div id="freeCard" class="lane-card">Free Request</div>
    <div id="priorityCard" class="lane-card">Priority</div>
  </div>

  <!-- Payment options for Priority -->
  <div id="paymentOptions">
    <button id="paypalBtn">Pay with PayPal</button>
    <button id="cashBtn">Pay with Cash</button>
  </div>

  <!-- Request form -->
  <form id="requestForm">
    <input name="song" placeholder="Song name" required>
    <input name="artist" placeholder="Artist name" required>
    <input name="name" placeholder="Your name (optional)">
    <input type="hidden" id="lane" name="lane">
    <input type="hidden" id="payment" name="payment">
    <button type="submit" class="submit-btn">Submit Request</button>
  </form>

  <!-- Live lanes -->
  <div class="lanes">
    <div class="lane">
      <h3>FREE LANE</h3>
      <div id="freeLane"></div>
    </div>
    <div class="lane">
      <h3>PRIORITY</h3>
      <div id="priorityLane"></div>
    </div>
  </div>

  <!-- Admin -->
  <a href="admin.html">
    <button class="admin-btn">Admin Panel</button>
  </a>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCRzE9DheGAxan7h2NLB14Va3hI4Pc5EKM",
  authDomain: "aryauxsongrequest.firebaseapp.com",
  databaseURL: "https://aryauxsongrequest-default-rtdb.firebaseio.com",
  projectId: "aryauxsongrequest",
  storageBucket: "aryauxsongrequest.firebasestorage.app",
  messagingSenderId: "376455919089",
  appId: "1:376455919089:web:4962df21f4145b61c30050"
});

const db = firebase.database();
</script>

<script>
const freeCard = document.getElementById('freeCard');
const priorityCard = document.getElementById('priorityCard');
const paymentOptions = document.getElementById('paymentOptions');
const requestForm = document.getElementById('requestForm');
const laneInput = document.getElementById('lane');
const paymentInput = document.getElementById('payment');
const paypalBtn = document.getElementById('paypalBtn');
const cashBtn = document.getElementById('cashBtn');

let paypalSelected = false;

// Toggle lane open/close
freeCard.onclick = () => {
  const isOpen = requestForm.style.display === 'flex' && laneInput.value === 'free';
  if(isOpen){
    requestForm.style.display = 'none';
    freeCard.classList.remove('selected');
  } else {
    laneInput.value = 'free';
    paymentInput.value = 'free';
    paypalSelected = false;
    requestForm.style.display = 'flex';
    paymentOptions.style.display = 'none';
    freeCard.classList.add('selected');
    priorityCard.classList.remove('selected');
  }
};

priorityCard.onclick = () => {
  const isOpen = paymentOptions.style.display === 'flex' || (requestForm.style.display === 'flex' && laneInput.value === 'priority');
  if(isOpen){
    paymentOptions.style.display = 'none';
    requestForm.style.display = 'none';
    priorityCard.classList.remove('selected');
  } else {
    laneInput.value = '';
    paymentInput.value = '';
    paymentOptions.style.display = 'flex';
    requestForm.style.display = 'none';
    priorityCard.classList.add('selected');
    freeCard.classList.remove('selected');
  }
};

// Priority payment selection
paypalBtn.onclick = () => {
  laneInput.value = 'priority';
  paymentInput.value = 'paypal';
  paypalSelected = true;
  paymentOptions.style.display = 'none';
  requestForm.style.display = 'flex';
};

cashBtn.onclick = () => {
  laneInput.value = 'priority';
  paymentInput.value = 'cash';
  paypalSelected = false;
  paymentOptions.style.display = 'none';
  requestForm.style.display = 'flex';
};

// Submit
requestForm.addEventListener('submit', e => {
  e.preventDefault();

  const data = {
    song:e.target.song.value,
    artist:e.target.artist.value,
    name:e.target.name.value,
    lane:e.target.lane.value,
    payment:e.target.payment.value,
    status:'pending',
    timestamp:Date.now()
  };

  db.ref('requests').push(data).then(() => {
    requestForm.reset();
    requestForm.style.display = 'none';
    freeCard.classList.remove('selected');
    priorityCard.classList.remove('selected');

    if (paypalSelected) {
      window.location.href = "https://paypal.me/aryaux";
    } else {
      alert("Request sent! Please pay cash at the DJ booth.");
    }
  });
});

// Render approved lanes
function formatTime(ts){
  const d=new Date(ts);
  let h=d.getHours(),m=d.getMinutes();
  const a=h>=12?'PM':'AM';
  h=h%12||12; m=m<10?'0'+m:m;
  return `${h}:${m} ${a}`;
}

db.ref('requests').on('value', snap=>{
  document.getElementById('freeLane').innerHTML='';
  document.getElementById('priorityLane').innerHTML='';
  snap.forEach(c=>{
    const r=c.val();
    if(r.status!=='approved') return;
    const div=document.createElement('div');
    div.className='request'+(r.lane==='priority'?' approved-priority':'');
    div.innerHTML=`<strong>${r.song}</strong> â€“ ${r.artist}<br><small>${r.name||''} | ${formatTime(r.timestamp)}</small>`;
    (r.lane==='priority'?document.getElementById('priorityLane'):document.getElementById('freeLane')).appendChild(div);
  });
});
</script>

</body>
</html>
