<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Admin Panel</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --panel:rgba(30,30,35,0.85);
  --border:rgba(255,255,255,0.08);
  --text:#e5e5e5;
  --accent:#00ffd0;
  --gold:#d4af37;
  --highlight:#ff4d4d;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Montserrat',sans-serif;
  background:linear-gradient(180deg,#0b0b0d,#0a0a0a);
  color:var(--text);
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
  min-height:100vh;
}

h1{
  text-align:center;
  margin-bottom:20px;
}

.container{
  width:100%;
  max-width:600px;
  display:flex;
  flex-direction:column;
  gap:20px;
}

/* Login */
#loginPanel{
  display:flex;
  flex-direction:column;
  gap:12px;
  background:var(--panel);
  padding:20px;
  border-radius:16px;
  border:1px solid var(--border);
}

#loginPanel input{
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#111;
  color:white;
}

#loginPanel button{
  background:linear-gradient(135deg,var(--highlight),#ff1a66);
  color:white;
  border:none;
  padding:14px;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
}

/* Requests */
.requestsPanel{
  display:none;
  flex-direction:column;
  gap:16px;
}

.laneSection{
  background:var(--panel);
  padding:16px;
  border-radius:16px;
  border:1px solid var(--border);
}

.laneSection h3{
  margin-bottom:12px;
  color:var(--accent);
}

.request{
  padding:10px 12px;
  border-radius:12px;
  background:rgba(20,20,25,0.85);
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.request.priority{
  animation: goldPulse 3s ease infinite;
  background:linear-gradient(270deg,var(--gold),#ffec9e,var(--gold));
  background-size:300% 300%;
  color:black;
}

@keyframes goldPulse{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.request button{
  margin-left:6px;
  padding:6px 10px;
  border:none;
  border-radius:10px;
  font-size:12px;
  font-weight:600;
  cursor:pointer;
}

.approveBtn{background:#00ffd0;color:black;}
.denyBtn{background:#ff4d4d;color:white;}
</style>
</head>

<body>

<h1>ðŸŽµ Admin Panel</h1>

<div class="container">

  <!-- Login -->
  <div id="loginPanel">
    <input type="password" id="adminPassword" placeholder="Enter Admin Password">
    <button id="loginBtn">Login</button>
  </div>

  <!-- Requests -->
  <div id="requestsPanel" class="requestsPanel">

    <div class="laneSection">
      <h3>Free Requests</h3>
      <div id="freeRequests"></div>
    </div>

    <div class="laneSection">
      <h3>Priority Requests</h3>
      <div id="priorityRequests"></div>
    </div>

  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCRzE9DheGAxan7h2NLB14Va3hI4Pc5EKM",
  authDomain: "aryauxsongrequest.firebaseapp.com",
  databaseURL: "https://aryauxsongrequest-default-rtdb.firebaseio.com",
  projectId: "aryauxsongrequest",
  storageBucket: "aryauxsongrequest.firebasestorage.app",
  messagingSenderId: "376455919089",
  appId: "1:376455919089:web:4962df21f4145b61c30050"
});

const db = firebase.database();
</script>

<script>
/* ---------- LOGIN ---------- */
const ADMIN_PASSWORD = "1234";

const loginBtn = document.getElementById('loginBtn');
const passwordInput = document.getElementById('adminPassword');
const loginPanel = document.getElementById('loginPanel');
const requestsPanel = document.getElementById('requestsPanel');

loginBtn.onclick = () => {
  if(passwordInput.value === ADMIN_PASSWORD){
    loginPanel.style.display = 'none';
    requestsPanel.style.display = 'flex';
  } else {
    alert("Incorrect Password");
  }
};

/* ---------- RENDER REQUESTS ---------- */
function renderRequests(){
  db.ref('requests').on('value', snapshot => {
    const data = snapshot.val() || {};
    const freeDiv = document.getElementById('freeRequests');
    const priorityDiv = document.getElementById('priorityRequests');

    freeDiv.innerHTML = '';
    priorityDiv.innerHTML = '';

    Object.keys(data).forEach(key => {
      const r = data[key];
      if(r.status === 'approved') return;

      const div = document.createElement('div');
      div.className = 'request';
      if(r.lane === 'priority') div.classList.add('priority');

      div.innerHTML = `
        <span>
          <strong>${r.song}</strong> â€“ ${r.artist}<br>
          <small>${r.name || ''}</small>
        </span>
      `;

      const approveBtn = document.createElement('button');
      approveBtn.className = 'approveBtn';
      approveBtn.textContent = 'Approve';
      approveBtn.onclick = () => {
        db.ref('requests/' + key + '/status').set('approved');
      };

      const denyBtn = document.createElement('button');
      denyBtn.className = 'denyBtn';
      denyBtn.textContent = 'Deny';
      denyBtn.onclick = () => {
        db.ref('requests/' + key).remove();
      };

      div.appendChild(approveBtn);
      div.appendChild(denyBtn);

      if(r.lane === 'priority'){
        priorityDiv.appendChild(div);
      } else {
        freeDiv.appendChild(div);
      }
    });
  });
}

renderRequests();
</script>

</body>
</html>
